package relayer

import (
	"bytes"
	"strconv"
	"time"

	"github.com/celer-network/bsc-relayer/common"
	"github.com/celer-network/bsc-relayer/executor"
	"github.com/celer-network/bsc-relayer/model"
	"github.com/celer-network/goutils/log"
	common2 "github.com/ethereum/go-ethereum/common"
)

var header36647110 = common2.Hex2Bytes("df1e0af40e0abc020a02080a121442696e616e63652d436861696e2d47616e67657318c6e1bc11220c0881e5ef9f0610898ddedd0130de907c3a480a208c003d30b25653c4da6ee1b98e4016be5a01a3a2cfa6bf1c6085446e278220d012240801122070cac0a3c218b95a285654344c18b3b59c9809773314559f897b2107d706086c422037e2f57fd5bf10428ca5ad2a366e76fd6bb03b615d6772a328aaea48b8c3c49c5220dfb10d5c6390b8d4c63cdeffc6a27ebae82ccd0aa0f87cac8de3a1d9776f11535a20dfb10d5c6390b8d4c63cdeffc6a27ebae82ccd0aa0f87cac8de3a1d9776f11536220294d8fbd0b94b767a7eba9840f299a3586da7fe6b5dead3b7eecba193c400f936a203f62ccfa03c1484dcb27e572697791bd51d0255eb3736aa57ad288c0889a859a820114b3727172ce6473bc780298a2d66c12f1a14f5b2a12b20c0a480a20650d47dabf8b8c73ff146af9ff33390776277e885e2afa929cb439fdf7d8a9bb122408011220fe26031c16477b02abae5ec5cf8819678bb7694bead93923019547b067667bfc120012b901080210c6e1bc1122480a20650d47dabf8b8c73ff146af9ff33390776277e885e2afa929cb439fdf7d8a9bb122408011220fe26031c16477b02abae5ec5cf8819678bb7694bead93923019547b067667bfc2a0c0883e5ef9f0610e4e6bbf602321418e69cc672973992bb5f76d049a5b2c5ddf7743638014240056ade4fecc2ff8467cf72e9d3dc28dcf7dad9b8bd4024ea423a17b12f6d71bf90933f0e92aaba99368940c9a0e037cab6277e770e16e8a41a3f53289d251d0e12b901080210c6e1bc1122480a20650d47dabf8b8c73ff146af9ff33390776277e885e2afa929cb439fdf7d8a9bb122408011220fe26031c16477b02abae5ec5cf8819678bb7694bead93923019547b067667bfc2a0c0883e5ef9f0610a0acdbf6023214344c39bb8f4512d6cab1f6aafac1811ef9d8afdf3802424063ff683fc10b817cb58c72b7a47f01cfd1b67b1ef6ca3f035b67c66075387765191741d20e70394f458c3d58a6638a6d98c9f563f0efe2b73a31e1f4e4dc7e07120012b901080210c6e1bc1122480a20650d47dabf8b8c73ff146af9ff33390776277e885e2afa929cb439fdf7d8a9bb122408011220fe26031c16477b02abae5ec5cf8819678bb7694bead93923019547b067667bfc2a0c0883e5ef9f061095a6b7ea02321462633d9db7ed78e951f79913fdc8231aa77ec12b380442408d6d43838538c31747e17ec7879bfae1dea6a9a57400397c2c9581d80896b8cf6952571354b7ae08ceee97120f9bb2f1924df1e4774bcc95c33b70969ab76b0312b901080210c6e1bc1122480a20650d47dabf8b8c73ff146af9ff33390776277e885e2afa929cb439fdf7d8a9bb122408011220fe26031c16477b02abae5ec5cf8819678bb7694bead93923019547b067667bfc2a0c0883e5ef9f0610d7dae7f602321491844d296bd8e591448efc65fd6ad51a888d58fa38054240530dce5238b2a87f3d9a4430262a39b3ae6de76e8e0ca32581cb65f5e968dc6a38c1836509602d4a3e9582d715ffb275a265f4050dc7f700956ea053b730c80312b901080210c6e1bc1122480a20650d47dabf8b8c73ff146af9ff33390776277e885e2afa929cb439fdf7d8a9bb122408011220fe26031c16477b02abae5ec5cf8819678bb7694bead93923019547b067667bfc2a0c0883e5ef9f0610b0aac7e80232149ccddd479c0ad8dcd01d754dd95fe15384e8bbdc380642402562d375414f80da658ba1afcee5d4ad1eeb60bc93ab449d18225a044fb51c7df4b3416a2f24efce32dc4022f36d86508da6785f603ef831adea7ae02445760b1200120012b901080210c6e1bc1122480a20650d47dabf8b8c73ff146af9ff33390776277e885e2afa929cb439fdf7d8a9bb122408011220fe26031c16477b02abae5ec5cf8819678bb7694bead93923019547b067667bfc2a0c0883e5ef9f0610d6d6d6ea023214d4cecef238e778c7063552c3a7ab95da35c3fb4738094240124ee835809434a2e5f1063d649ef539e4586c2130d141e4fcbc32536062095cbf25ae7d59cf9d6d415b2dcbc69b2897f1fc67c711e5a9fd125b6e207b82b20112b901080210c6e1bc1122480a20650d47dabf8b8c73ff146af9ff33390776277e885e2afa929cb439fdf7d8a9bb122408011220fe26031c16477b02abae5ec5cf8819678bb7694bead93923019547b067667bfc2a0c0883e5ef9f0610e0a2d9d9023214f15ab82564d6f450ca6f30a074568a5e6dee7b9b380a4240a350132187508dac7d7380896e67330b68fcbd1868e56965e37db90ab4b873bcfe8baae2bd26ea374a6d04b7a9fc9f5e02c2b9934f4bc19f86674a785ede2d0f12b901080210c6e1bc1122480a20650d47dabf8b8c73ff146af9ff33390776277e885e2afa929cb439fdf7d8a9bb122408011220fe26031c16477b02abae5ec5cf8819678bb7694bead93923019547b067667bfc2a0c0883e5ef9f0610b982d8e8023214f42f1d05ac568d12e26b9655395e7fbbd46bc5bb380b42401572c8486ae6f3d5197caccff43f34bae0a4b1220585168a0204004b9e01e99102625ec11d85d7c4714c8dcffd5527606944e2c59e3b4c091b70ac4460c9cd0e12f1070a4b0a1406fd60078eb4c2356137dd50036597db267cf61612251624de6420e17cbe9c20cdcfdf876b3b12978d3264a007fcaaa71c4cdb701d9ebc0323f44f1880a094a58d1d2080a094a58d1d0a4b0a1418e69cc672973992bb5f76d049a5b2c5ddf7743612251624de6420184e7b103d34c41003f9b864d5f8c1adda9bd0436b253bb3c844bc739c1e77c91880a094a58d1d2080a094a58d1d0a4b0a14344c39bb8f4512d6cab1f6aafac1811ef9d8afdf12251624de64204d420aea843e92a0cfe69d89696dff6827769f9cb52a249af537ce89bf2a4b741880a094a58d1d2080a094a58d1d0a4b0a1437ef19af29679b368d2b9e9de3f8769b3578667612251624de6420bd03de9f8ab29e2800094e153fac6f696cfa512536c9c2f804dcb2c2c4e4aed61880a094a58d1d2080a094a58d1d0a4b0a1462633d9db7ed78e951f79913fdc8231aa77ec12b12251624de64208f4a74a07351895ddf373057b98fae6dfaf2cd21f37a063e19601078fe470d531880a094a58d1d2080a094a58d1d0a4b0a1491844d296bd8e591448efc65fd6ad51a888d58fa12251624de6420c80e9abef7ff439c10c68fe8f1303deddfc527718c3b37d8ba6807446e3c827a1880a094a58d1d2080a094a58d1d0a4f0a149ccddd479c0ad8dcd01d754dd95fe15384e8bbdc12251624de64204d1be64f0e9a466c2e66a53433928192783e29f8fa21beb2133499b5ef770f601880c0a8ca9a3a2080808dc2e0a2fdffff010a4b0a14b3727172ce6473bc780298a2d66c12f1a14f5b2a12251624de64209142afcc691b7cc05d26c7b0be0c8b46418294171730e079f384fde2fa50bafc1880a094a58d1d2080a094a58d1d0a4b0a14b6f20c7faa2b2f6f24518fa02b71cb5f4a09fba312251624de642049b288e4ebbb3a281c2d546fc30253d5baf08993b6e5d295fb787a5b314a298e1880a094a58d1d2080a094a58d1d0a4b0a14d4cecef238e778c7063552c3a7ab95da35c3fb4712251624de642099308aa365c40554bc89982af505d85da95251445d5dd4a9bb37dd2584fd92d31880a094a58d1d2080a094a58d1d0a4b0a14f15ab82564d6f450ca6f30a074568a5e6dee7b9b12251624de6420df33205d0974d06f3f5d32e6fd98e5debd7ec39a796455f93c63aeef0dadb31a1880c0a8ca9a3a2080c0a8ca9a3a0a4b0a14f42f1d05ac568d12e26b9655395e7fbbd46bc5bb12251624de642001776920ff0b0f38d78cf95c033c21adf7045785114e392a7544179652e0a6121880a094a58d1d2080a094a58d1d124f0a149ccddd479c0ad8dcd01d754dd95fe15384e8bbdc12251624de64204d1be64f0e9a466c2e66a53433928192783e29f8fa21beb2133499b5ef770f601880c0a8ca9a3a2080808dc2e0a2fdffff011af1070a4b0a1406fd60078eb4c2356137dd50036597db267cf61612251624de6420e17cbe9c20cdcfdf876b3b12978d3264a007fcaaa71c4cdb701d9ebc0323f44f1880a094a58d1d2080a094a58d1d0a4b0a1418e69cc672973992bb5f76d049a5b2c5ddf7743612251624de6420184e7b103d34c41003f9b864d5f8c1adda9bd0436b253bb3c844bc739c1e77c91880a094a58d1d2080a094a58d1d0a4b0a14344c39bb8f4512d6cab1f6aafac1811ef9d8afdf12251624de64204d420aea843e92a0cfe69d89696dff6827769f9cb52a249af537ce89bf2a4b741880a094a58d1d2080a094a58d1d0a4b0a1437ef19af29679b368d2b9e9de3f8769b3578667612251624de6420bd03de9f8ab29e2800094e153fac6f696cfa512536c9c2f804dcb2c2c4e4aed61880a094a58d1d2080a094a58d1d0a4b0a1462633d9db7ed78e951f79913fdc8231aa77ec12b12251624de64208f4a74a07351895ddf373057b98fae6dfaf2cd21f37a063e19601078fe470d531880a094a58d1d2080a094a58d1d0a4b0a1491844d296bd8e591448efc65fd6ad51a888d58fa12251624de6420c80e9abef7ff439c10c68fe8f1303deddfc527718c3b37d8ba6807446e3c827a1880a094a58d1d2080a094a58d1d0a4f0a149ccddd479c0ad8dcd01d754dd95fe15384e8bbdc12251624de64204d1be64f0e9a466c2e66a53433928192783e29f8fa21beb2133499b5ef770f601880c0a8ca9a3a2080808dc2e0a2fdffff010a4b0a14b3727172ce6473bc780298a2d66c12f1a14f5b2a12251624de64209142afcc691b7cc05d26c7b0be0c8b46418294171730e079f384fde2fa50bafc1880a094a58d1d2080a094a58d1d0a4b0a14b6f20c7faa2b2f6f24518fa02b71cb5f4a09fba312251624de642049b288e4ebbb3a281c2d546fc30253d5baf08993b6e5d295fb787a5b314a298e1880a094a58d1d2080a094a58d1d0a4b0a14d4cecef238e778c7063552c3a7ab95da35c3fb4712251624de642099308aa365c40554bc89982af505d85da95251445d5dd4a9bb37dd2584fd92d31880a094a58d1d2080a094a58d1d0a4b0a14f15ab82564d6f450ca6f30a074568a5e6dee7b9b12251624de6420df33205d0974d06f3f5d32e6fd98e5debd7ec39a796455f93c63aeef0dadb31a1880c0a8ca9a3a2080c0a8ca9a3a0a4b0a14f42f1d05ac568d12e26b9655395e7fbbd46bc5bb12251624de642001776920ff0b0f38d78cf95c033c21adf7045785114e392a7544179652e0a6121880a094a58d1d2080a094a58d1d124f0a149ccddd479c0ad8dcd01d754dd95fe15384e8bbdc12251624de64204d1be64f0e9a466c2e66a53433928192783e29f8fa21beb2133499b5ef770f601880c0a8ca9a3a2080808dc2e0a2fdffff01")
var header36647111 = common2.Hex2Bytes("96230aab130abc020a02080a121442696e616e63652d436861696e2d47616e67657318c7e1bc11220c0883e5ef9f0610b982d8e80230de907c3a480a20650d47dabf8b8c73ff146af9ff33390776277e885e2afa929cb439fdf7d8a9bb122408011220fe26031c16477b02abae5ec5cf8819678bb7694bead93923019547b067667bfc42201e4e0bf61f74b6d3525d8cf271158347aee8ffd58a450942b1d0c70b0b54f2db5220dfb10d5c6390b8d4c63cdeffc6a27ebae82ccd0aa0f87cac8de3a1d9776f11535a20dfb10d5c6390b8d4c63cdeffc6a27ebae82ccd0aa0f87cac8de3a1d9776f11536220294d8fbd0b94b767a7eba9840f299a3586da7fe6b5dead3b7eecba193c400f936a20f424cfedc2c1eed26a47d4604a976aa9b71a4741119a6f442e2cddee60fea467820114d4cecef238e778c7063552c3a7ab95da35c3fb4712e9100a480a20412e2028a40e237606b643285a36be4b5a7a0cb91f60c166333a41d3f3bc3e0c122408011220763c6cff44572f89a2fadac4f06c5edae02553ac79e4c7008068cb5406876c5412b801080210c7e1bc11180122480a20412e2028a40e237606b643285a36be4b5a7a0cb91f60c166333a41d3f3bc3e0c122408011220763c6cff44572f89a2fadac4f06c5edae02553ac79e4c7008068cb5406876c542a0b088be5ef9f0610d3cef828321406fd60078eb4c2356137dd50036597db267cf6164240f6cdbfc0b46526f7097e51accda3700d4bfdc191b0860a2936d7800f1d7926470bddb7b4d6635261d57f467c7a0f8286e8c01cf0e4e77b7a91684426173e110012ba01080210c7e1bc11180122480a20412e2028a40e237606b643285a36be4b5a7a0cb91f60c166333a41d3f3bc3e0c122408011220763c6cff44572f89a2fadac4f06c5edae02553ac79e4c7008068cb5406876c542a0b088be5ef9f061081e99938321418e69cc672973992bb5f76d049a5b2c5ddf7743638014240d7ab14f60b2917ff56def0402ea70cfad45fdf05c0aa57ee5fdb5ea0709010d5734016f89d539dafbb13536cd83433cdbb600d89a2a33d09c8f5121e5234be0b12ba01080210c7e1bc11180122480a20412e2028a40e237606b643285a36be4b5a7a0cb91f60c166333a41d3f3bc3e0c122408011220763c6cff44572f89a2fadac4f06c5edae02553ac79e4c7008068cb5406876c542a0b088be5ef9f0610b0ebcf373214344c39bb8f4512d6cab1f6aafac1811ef9d8afdf38024240b8397b44482aa2b8025ca0caab5d575988f78c0121f4ea179badbee9463d536fde3bc198e42b4aee2972ebaba68032658779013b35073099143062c73364420312ba01080210c7e1bc11180122480a20412e2028a40e237606b643285a36be4b5a7a0cb91f60c166333a41d3f3bc3e0c122408011220763c6cff44572f89a2fadac4f06c5edae02553ac79e4c7008068cb5406876c542a0b088be5ef9f0610ffc19628321437ef19af29679b368d2b9e9de3f8769b357866763803424077ce67380fc65dea32d070d2bf0ee9b366edf0a6012c43db59e420232915184ef753b1848287c243e63d0f9e789c3eb62ae7b41b0e4877dd5aa5eab6367a3b0e12ba01080210c7e1bc11180122480a20412e2028a40e237606b643285a36be4b5a7a0cb91f60c166333a41d3f3bc3e0c122408011220763c6cff44572f89a2fadac4f06c5edae02553ac79e4c7008068cb5406876c542a0b088be5ef9f0610ff98ca57321462633d9db7ed78e951f79913fdc8231aa77ec12b380442404bcf26f9894544380dd2f2ba06d41d3ccd51128a0833acd450c82f3aa07afcc3636e3a59d7fa615b2826f50c1da398a260a50a2b981441072328c2c7d8ad070712ba01080210c7e1bc11180122480a20412e2028a40e237606b643285a36be4b5a7a0cb91f60c166333a41d3f3bc3e0c122408011220763c6cff44572f89a2fadac4f06c5edae02553ac79e4c7008068cb5406876c542a0b088be5ef9f0610f2e29c38321491844d296bd8e591448efc65fd6ad51a888d58fa38054240c65f3baa46b6708346b67e1a8599a77a0d4af425cc45b6746b125ae8bd2ae9e08c3f7f87ab8a1556a9596414c398819fef9cf39322e1eb2f6df0883c3073170512ba01080210c7e1bc11180122480a20412e2028a40e237606b643285a36be4b5a7a0cb91f60c166333a41d3f3bc3e0c122408011220763c6cff44572f89a2fadac4f06c5edae02553ac79e4c7008068cb5406876c542a0b088be5ef9f0610f1b9f75732149ccddd479c0ad8dcd01d754dd95fe15384e8bbdc3806424079fec2fec0905209ed2638fa9caeab6ee1ea23d56cfbc23d558ba9fb029b953924c1bc3c5d86b1af0e7750f4175d2b727f705db75f40c7e0192fb4059970e50512ba01080210c7e1bc11180122480a20412e2028a40e237606b643285a36be4b5a7a0cb91f60c166333a41d3f3bc3e0c122408011220763c6cff44572f89a2fadac4f06c5edae02553ac79e4c7008068cb5406876c542a0b088be5ef9f06108a96ff373214b3727172ce6473bc780298a2d66c12f1a14f5b2a380742405eb8d3203ba58792d841aee097deb64b29f432427c6a18b91b2a4b30f51cad9b2abd691641eef4b4127ed1b44147bedaab5d31e179a703f8e0ee8ac3bfb8cb0712ba01080210c7e1bc11180122480a20412e2028a40e237606b643285a36be4b5a7a0cb91f60c166333a41d3f3bc3e0c122408011220763c6cff44572f89a2fadac4f06c5edae02553ac79e4c7008068cb5406876c542a0b088be5ef9f06108eef91283214b6f20c7faa2b2f6f24518fa02b71cb5f4a09fba3380842409bbbaa893605807afa22c93c135174a47637ec98fdab5902b504e1c94d3a85667c28a0523c2e3c5d7937d2219a2977be68da302c7ff4f9ef24b9637655056f0712ba01080210c7e1bc11180122480a20412e2028a40e237606b643285a36be4b5a7a0cb91f60c166333a41d3f3bc3e0c122408011220763c6cff44572f89a2fadac4f06c5edae02553ac79e4c7008068cb5406876c542a0b088be5ef9f0610f4e9ef573214d4cecef238e778c7063552c3a7ab95da35c3fb47380942402979666d8bb3a8cb016995a5439572368e9ab5a79e12d52050908114afe744d1eb72aff2827d28cb6776fce87e5112b079f7bf9ae52d8176c789d60813dc1f07120012ba01080210c7e1bc11180122480a20412e2028a40e237606b643285a36be4b5a7a0cb91f60c166333a41d3f3bc3e0c122408011220763c6cff44572f89a2fadac4f06c5edae02553ac79e4c7008068cb5406876c542a0b088be5ef9f0610a8b8c9573214f42f1d05ac568d12e26b9655395e7fbbd46bc5bb380b4240f76e20c633f302aae5f015b0030874a0fc10cabf9b09c377220e1cc609db4f80bc75b6f627a216d4a31403845fa828479c35cf82d9e07142f38cf3ec7d65d50412f1070a4b0a1406fd60078eb4c2356137dd50036597db267cf61612251624de6420e17cbe9c20cdcfdf876b3b12978d3264a007fcaaa71c4cdb701d9ebc0323f44f1880a094a58d1d2080a094a58d1d0a4b0a1418e69cc672973992bb5f76d049a5b2c5ddf7743612251624de6420184e7b103d34c41003f9b864d5f8c1adda9bd0436b253bb3c844bc739c1e77c91880a094a58d1d2080a094a58d1d0a4b0a14344c39bb8f4512d6cab1f6aafac1811ef9d8afdf12251624de64204d420aea843e92a0cfe69d89696dff6827769f9cb52a249af537ce89bf2a4b741880a094a58d1d2080a094a58d1d0a4b0a1437ef19af29679b368d2b9e9de3f8769b3578667612251624de6420bd03de9f8ab29e2800094e153fac6f696cfa512536c9c2f804dcb2c2c4e4aed61880a094a58d1d2080a094a58d1d0a4b0a1462633d9db7ed78e951f79913fdc8231aa77ec12b12251624de64208f4a74a07351895ddf373057b98fae6dfaf2cd21f37a063e19601078fe470d531880a094a58d1d2080a094a58d1d0a4b0a1491844d296bd8e591448efc65fd6ad51a888d58fa12251624de6420c80e9abef7ff439c10c68fe8f1303deddfc527718c3b37d8ba6807446e3c827a1880a094a58d1d2080a094a58d1d0a4f0a149ccddd479c0ad8dcd01d754dd95fe15384e8bbdc12251624de64204d1be64f0e9a466c2e66a53433928192783e29f8fa21beb2133499b5ef770f601880c0a8ca9a3a2080808dc2e0a2fdffff010a4b0a14b3727172ce6473bc780298a2d66c12f1a14f5b2a12251624de64209142afcc691b7cc05d26c7b0be0c8b46418294171730e079f384fde2fa50bafc1880a094a58d1d2080a094a58d1d0a4b0a14b6f20c7faa2b2f6f24518fa02b71cb5f4a09fba312251624de642049b288e4ebbb3a281c2d546fc30253d5baf08993b6e5d295fb787a5b314a298e1880a094a58d1d2080a094a58d1d0a4b0a14d4cecef238e778c7063552c3a7ab95da35c3fb4712251624de642099308aa365c40554bc89982af505d85da95251445d5dd4a9bb37dd2584fd92d31880a094a58d1d2080a094a58d1d0a4b0a14f15ab82564d6f450ca6f30a074568a5e6dee7b9b12251624de6420df33205d0974d06f3f5d32e6fd98e5debd7ec39a796455f93c63aeef0dadb31a1880c0a8ca9a3a2080c0a8ca9a3a0a4b0a14f42f1d05ac568d12e26b9655395e7fbbd46bc5bb12251624de642001776920ff0b0f38d78cf95c033c21adf7045785114e392a7544179652e0a6121880a094a58d1d2080a094a58d1d124f0a149ccddd479c0ad8dcd01d754dd95fe15384e8bbdc12251624de64204d1be64f0e9a466c2e66a53433928192783e29f8fa21beb2133499b5ef770f601880c0a8ca9a3a2080808dc2e0a2fdffff011af1070a4b0a1406fd60078eb4c2356137dd50036597db267cf61612251624de6420e17cbe9c20cdcfdf876b3b12978d3264a007fcaaa71c4cdb701d9ebc0323f44f1880a094a58d1d2080a094a58d1d0a4b0a1418e69cc672973992bb5f76d049a5b2c5ddf7743612251624de6420184e7b103d34c41003f9b864d5f8c1adda9bd0436b253bb3c844bc739c1e77c91880a094a58d1d2080a094a58d1d0a4b0a14344c39bb8f4512d6cab1f6aafac1811ef9d8afdf12251624de64204d420aea843e92a0cfe69d89696dff6827769f9cb52a249af537ce89bf2a4b741880a094a58d1d2080a094a58d1d0a4b0a1437ef19af29679b368d2b9e9de3f8769b3578667612251624de6420bd03de9f8ab29e2800094e153fac6f696cfa512536c9c2f804dcb2c2c4e4aed61880a094a58d1d2080a094a58d1d0a4b0a1462633d9db7ed78e951f79913fdc8231aa77ec12b12251624de64208f4a74a07351895ddf373057b98fae6dfaf2cd21f37a063e19601078fe470d531880a094a58d1d2080a094a58d1d0a4b0a1491844d296bd8e591448efc65fd6ad51a888d58fa12251624de6420c80e9abef7ff439c10c68fe8f1303deddfc527718c3b37d8ba6807446e3c827a1880a094a58d1d2080a094a58d1d0a4f0a149ccddd479c0ad8dcd01d754dd95fe15384e8bbdc12251624de64204d1be64f0e9a466c2e66a53433928192783e29f8fa21beb2133499b5ef770f601880c0a8ca9a3a2080808dc2e0a2fdffff010a4b0a14b3727172ce6473bc780298a2d66c12f1a14f5b2a12251624de64209142afcc691b7cc05d26c7b0be0c8b46418294171730e079f384fde2fa50bafc1880a094a58d1d2080a094a58d1d0a4b0a14b6f20c7faa2b2f6f24518fa02b71cb5f4a09fba312251624de642049b288e4ebbb3a281c2d546fc30253d5baf08993b6e5d295fb787a5b314a298e1880a094a58d1d2080a094a58d1d0a4b0a14d4cecef238e778c7063552c3a7ab95da35c3fb4712251624de642099308aa365c40554bc89982af505d85da95251445d5dd4a9bb37dd2584fd92d31880a094a58d1d2080a094a58d1d0a4b0a14f15ab82564d6f450ca6f30a074568a5e6dee7b9b12251624de6420df33205d0974d06f3f5d32e6fd98e5debd7ec39a796455f93c63aeef0dadb31a1880c0a8ca9a3a2080c0a8ca9a3a0a4b0a14f42f1d05ac568d12e26b9655395e7fbbd46bc5bb12251624de642001776920ff0b0f38d78cf95c033c21adf7045785114e392a7544179652e0a6121880a094a58d1d2080a094a58d1d124f0a149ccddd479c0ad8dcd01d754dd95fe15384e8bbdc12251624de64204d1be64f0e9a466c2e66a53433928192783e29f8fa21beb2133499b5ef770f601880c0a8ca9a3a2080808dc2e0a2fdffff01")
var msgFor1733 = common2.Hex2Bytes("000000000000000000000000000000000000000000000000000008e1bc9bf04000f9028b80f90287f846941284214b9b9c85549ab3d2b972df0deef66ac2c9946ddf42a51534fc98d0c0a3b42c963cace8441ddf9477f066f3fb515bb97015e4b4afddbcb25c94286b863a79e31a06b2f84694a2959d3f95eae5dc7d70144ce1b73b403b7eb6e0948081ef03f1d9e0bb4a5bf38f16285c879299f07f940ce09b38374887cb564b7efa60be130d99ed5f958634396b4d74cff84694b71b214cb885500844365e95cd9942c7276e7fd894d22ca3ba2141d23adab65ce4940eb7665ea2b6a794748c284f46ab87fd492326f1e2fe731d22ad2db3862c883c110c10f84694980a75ecd1309ea12fa2ed87a8744fbfc9b863d594cc6ac05c95a99c1f7b5f88de0e3486c82293b2709407eecf36cf0901fefe4bc505d6ba03c7480c7b57862bb8b2be9df3f8469435552c16704d214347f29fa77f77da6d75d7c75294dc4973e838e3949c77aced16ac2315dc2d7ab11194f57d36e129881a3a13a024fe8072507e5b2e70f8862b52882254abf84694f474cf03cceff28abc65c9cbae594f725c80e12d94e61a183325a18a173319dd8e19c8d069459e217594ddfcaedf9bb451098c9917a45f02bd61342cca6686185341bfab86f8469496c5d20b2a975c050e4220be276ace4892f4b41a9496c5d20b2a975c050e4220be276ace4892f4b41a94d83534ce35b13f84f54d11fa1d433dee3c75f9f9860e81cd624942f84694c5d15ef572d27f4f3087e17ee9099b760b1151c294c5d15ef572d27f4f3087e17ee9099b760b1151c294749678d00a66b8a820d92ad6131f3dcd47a91321860100f3a059c0f845946d6247501b822fd4eaa76fcb64baea360279497f941e481301b8c32d6a3d318b54aad7bc4a5c2b1caa94f6001c9d74e1ba71769f0633f6d690febd9b970b85ea4c276f00")
var proofFor1733 = common2.Hex2Bytes("0a84060a066961766c3a76120e00000100610800000000000006c51ae905e7050ae4050a2c080f10ac4f18c6e1bc1122206dbbc25bbb1e725c2128fd27aca6c2f01214a35b4198f77dcd53ce4876fce94d0a2c080e10a62618c6e1bc112220659c705958bb2e7b06c169ce217161dea38375e8e083b5e8a692ca11bc8596a40a2c080d10941218c6e1bc11222046b901f9068f952268e3dbfdb72954b78b90c2ce14757934f76d07601fc9f8af0a2c080c10d70b18c6e1bc112a203298b03d872ee48bd66a8b57c6c23bf6c4dd4b0142f1a1384dac03124aa4343c0a2c080b10920818c6e1bc112220ff0dc31de2fca920a4140ba3de827e2dbdaeb7ba553ae4b07f35b9e023e7bea50a2c080a10920418c6e1bc1122202440798090528dfa52f65fcf7485c1abd82c01415a4e1f42dccdb74c41060ff80a2c080910920218c6e1bc112220de10985ce05b98f3d64683d1b5e0cb7bbcd46f1008bbf05c5236404ef7f6c6bf0a2c080810920118c6e1bc11222016a5b5c7745e4c0e85691264cdb181a2a0fdf8c3312f364c442889a4efc94c260a2b0807105218c6e1bc112220c52b24da586e113b532c4cefabcecf4a12a9e8dd9b0315e240af2fd875496c890a2b0806103218c6e1bc1122201efdd90ce73fb1c410e5f3173df6494f4322df431a540cb32972b03db45141bb0a2b0805101218c6e1bc1122202499bd1a49e30c2c595d184ddd96a763eef7d9abf3c4d89a2bf6db18bf64aaca0a2b0804100a18c6e1bc11222064fed245a406a30222ef126a83903ac3f8086c7d0bc349f318a712651a7619030a2b0803100618c6e1bc1122209c3d15827439377d3fc5e1bf7e476824b971589a98838f8ed61749c3d115646d0a2b0802100418c6e1bc112220e328c7f0ec295c05a20e64f45f2c450b8920874454a946909729ea9810025f710a2b0801100218c6e1bc112220020c653e1b176c2f1e04b6b48ef593f8b37e6575ecc9e80afb153eb0c54010a01a370a0e00000100610800000000000006c51220b31fa164eafeb60527ccd3c3e2174eb4ac8436f2364becf0adadaa4b25b0487518c6e1bc110ab1060a0a6d756c746973746f726512036962631a9d069b060a98060a390a0c7374616b655f72657761726412290a2708c6e1bc11122051728bee3e249faf3d3961bad626b27d28ef850900080f1bc49d5da8ae1aaea90a300a03676f7612290a2708c6e1bc1112209ec52456da0f878dbc7070d650e728bb8efa3cfcf7578a2822efe4e519ca3f830a300a0369626312290a2708c6e1bc111220922494778ad8e7c0d2ea0f986626eb40ab6ecbf7179a00ae112c7f6aab704a560a300a0361636312290a2708c6e1bc1112209ba4b575f4869635db0205afb3186b9bc4106c40d174ea26b1264b07988077c30a330a06746f6b656e7312290a2708c6e1bc111220b19c4b0458dffa6ce947441c46caded89a772f548c03f524f49ff926d2173a330a330a0662726964676512290a2708c6e1bc1112208ac15f258b9c05d02a525b620849ffb6db34bd0230730041d1791bf0c7cb22b90a0f0a046d61696e12070a0508c6e1bc110a360a0974696d655f6c6f636b12290a2708c6e1bc1112209094c71319a18c11c2a218c0827be8131dd3b8aeccc1848de9ecf5114513e2a90a0e0a0376616c12070a0508c6e1bc110a2f0a02736312290a2708c6e1bc11122072907da76fe5d1bc2aeb2df528b07d2bca618d68938f987374b0786e0cd290680a300a0364657812290a2708c6e1bc111220961593607d865ee74a27271267f51023a3809497736ef86c7576a336f31a76100a320a057374616b6512290a2708c6e1bc111220f2aa30e3e426dd34a21b0e5a018717dcacaa54ffd1f9c2d9173efc39313fdcf60a320a05706169727312290a2708c6e1bc111220000393af0e81db9044a54af8cfed59d74fe15c309a00867ff97cf06fb75e47670a350a08736c617368696e6712290a2708c6e1bc111220ef9eceff7768bc687de691224ecdab1cb47c50a8590475e2e6af27d3ed9f7e180a110a066f7261636c6512070a0508c6e1bc110a380a0b61746f6d69635f7377617012290a2708c6e1bc111220ef41d4cf90bf23bf5e5e89fd533bc06c95a050fe6ba7f58d379cd0993c52fdb60a330a06706172616d7312290a2708c6e1bc111220db9a4440e34c6975caf0fa8f7832fe620f8fd8c623b070000bcdd443f0beb4fd")

var header37055763 = common2.Hex2Bytes("ce210ae3110abc020a02080a121442696e616e63652d436861696e2d47616e6765731893dad511220c0880e6a9a006108acea18e02309d977c3a480a20194170db2363a206773125d91db0ee6a886b857f32b240efe59dcdf44fde33ef1224080112201d959e4ff05a282a964d4f9fe83c1a20fcb57b4b8ea2f62c5a6df3c18e8268fa4220b4467399a3979ea256e221cc6c9493ed616df596df1b7628f558cc31c97284665220dfb10d5c6390b8d4c63cdeffc6a27ebae82ccd0aa0f87cac8de3a1d9776f11535a20dfb10d5c6390b8d4c63cdeffc6a27ebae82ccd0aa0f87cac8de3a1d9776f11536220294d8fbd0b94b767a7eba9840f299a3586da7fe6b5dead3b7eecba193c400f936a202a42e3d8c8e010f6f632621b2586a0173358b19830e6f3294ca15cce81234651820114f15ab82564d6f450ca6f30a074568a5e6dee7b9b12a10f0a480a20f766188b97724a28b894ce6b37f6d9361d30dbff175844490bc7a62309ba7a521224080112207ab22fb54f9df1e6810eb202fde3c555aeb0d978c55b79a9859e6e8000fa5ed412b70108021093dad51122480a20f766188b97724a28b894ce6b37f6d9361d30dbff175844490bc7a62309ba7a521224080112207ab22fb54f9df1e6810eb202fde3c555aeb0d978c55b79a9859e6e8000fa5ed42a0c0882e6a9a00610f8c7fccd03321406fd60078eb4c2356137dd50036597db267cf6164240d8b798f19ad2bc365a50422c8acd9f15cc6f7283c7a3f5f0542d82f73a4d0da3011d5b141f9781d604c5c6a17751c98f00c092a615a87b511d066c5329842a0312b90108021093dad51122480a20f766188b97724a28b894ce6b37f6d9361d30dbff175844490bc7a62309ba7a521224080112207ab22fb54f9df1e6810eb202fde3c555aeb0d978c55b79a9859e6e8000fa5ed42a0c0882e6a9a00610c5f7f3c103321418e69cc672973992bb5f76d049a5b2c5ddf774363801424067093bd599da5b84e2381c0654dcdf36e794d93ac2915337480b14de8aa65c533fb652a7028c78ad3e70de27b3acfa4a21fc287bb23652e66c4028b49042a70512b90108021093dad51122480a20f766188b97724a28b894ce6b37f6d9361d30dbff175844490bc7a62309ba7a521224080112207ab22fb54f9df1e6810eb202fde3c555aeb0d978c55b79a9859e6e8000fa5ed42a0c0882e6a9a00610e8aeb2c2033214344c39bb8f4512d6cab1f6aafac1811ef9d8afdf3802424071563c481f6125d1e5eff1afdcecafb9c012c99558592981514fd5127cf586748a410fedb2adeb312de75114dbf148b74237a38b5d4bef80f5218bd3fd42840a12b90108021093dad51122480a20f766188b97724a28b894ce6b37f6d9361d30dbff175844490bc7a62309ba7a521224080112207ab22fb54f9df1e6810eb202fde3c555aeb0d978c55b79a9859e6e8000fa5ed42a0c0882e6a9a00610aaeba5d103321437ef19af29679b368d2b9e9de3f8769b3578667638034240c6a56bc7a2b3ddceb999b0eaff6217e09918b0e626191d90126501f2bdbe0a0056a386327995791c11a848019fdf47ad6e61988861a86028c3215ffc51e48f0912b80108021093dad51122480a20f766188b97724a28b894ce6b37f6d9361d30dbff175844490bc7a62309ba7a521224080112207ab22fb54f9df1e6810eb202fde3c555aeb0d978c55b79a9859e6e8000fa5ed42a0b0883e6a9a00610c2b0f907321462633d9db7ed78e951f79913fdc8231aa77ec12b38044240b683f80644a83889a39f0154c8d416078197156c74c1ca3598e4eb17611766ac1601ca834971591c551da5e5211c16504211fa4942313e193b8981fc3a0ab30e12b90108021093dad51122480a20f766188b97724a28b894ce6b37f6d9361d30dbff175844490bc7a62309ba7a521224080112207ab22fb54f9df1e6810eb202fde3c555aeb0d978c55b79a9859e6e8000fa5ed42a0c0882e6a9a00610a5e993c203321491844d296bd8e591448efc65fd6ad51a888d58fa380542405b1559f4c9e06bd526919cfc675b86ddaf3b3c4609a61cb4cfd75102d06f00d79f45ae3a04a82a4573e03413e55d940ddae287bbfe517f3e7be8f27c74316d03120012b90108021093dad51122480a20f766188b97724a28b894ce6b37f6d9361d30dbff175844490bc7a62309ba7a521224080112207ab22fb54f9df1e6810eb202fde3c555aeb0d978c55b79a9859e6e8000fa5ed42a0c0882e6a9a00610cf83f0c1033214b3727172ce6473bc780298a2d66c12f1a14f5b2a380742401b10d2bc612a86d82d28250f2f6b1d234185d380c8034c2ee3dc15598e17370692bfcda680dd95c4d6e10fcd81f84f66adb80242079194f27bcca90d507ffa0b12b90108021093dad51122480a20f766188b97724a28b894ce6b37f6d9361d30dbff175844490bc7a62309ba7a521224080112207ab22fb54f9df1e6810eb202fde3c555aeb0d978c55b79a9859e6e8000fa5ed42a0c0882e6a9a006108fb0d2cd033214b6f20c7faa2b2f6f24518fa02b71cb5f4a09fba338084240b36fa171e7dc0cc41e3edb233add1d4d0b26914d16535206d7fcdd01b79fa4d7d80552a6de040f886149c66e3a5ea8bb01355efe75923ae62bfca24f3397400f12b80108021093dad51122480a20f766188b97724a28b894ce6b37f6d9361d30dbff175844490bc7a62309ba7a521224080112207ab22fb54f9df1e6810eb202fde3c555aeb0d978c55b79a9859e6e8000fa5ed42a0b0883e6a9a00610eb9d83083214d4cecef238e778c7063552c3a7ab95da35c3fb4738094240b1d41bd38d533adb25dfef3eb456d0cace5b98c14cbab43a0dc0c3885eb7d95db454ecc6adb3aeac446d0d97aa8ac10d3087fe82a3694e9c18ba731fe0814f02120012b80108021093dad51122480a20f766188b97724a28b894ce6b37f6d9361d30dbff175844490bc7a62309ba7a521224080112207ab22fb54f9df1e6810eb202fde3c555aeb0d978c55b79a9859e6e8000fa5ed42a0b0883e6a9a00610ce899f073214f42f1d05ac568d12e26b9655395e7fbbd46bc5bb380b42409c121d0b7e9cc55754342897eec02fc8fa57d768f72294816e111eee7f376fe5b1a3af3bb6f2bff12845fe637311eb5df51aaa9a54aea7480d57d716d514af0012f1070a4b0a1406fd60078eb4c2356137dd50036597db267cf61612251624de6420e17cbe9c20cdcfdf876b3b12978d3264a007fcaaa71c4cdb701d9ebc0323f44f1880a094a58d1d2080a094a58d1d0a4b0a1418e69cc672973992bb5f76d049a5b2c5ddf7743612251624de6420184e7b103d34c41003f9b864d5f8c1adda9bd0436b253bb3c844bc739c1e77c91880a094a58d1d2080a094a58d1d0a4b0a14344c39bb8f4512d6cab1f6aafac1811ef9d8afdf12251624de64204d420aea843e92a0cfe69d89696dff6827769f9cb52a249af537ce89bf2a4b741880a094a58d1d2080a094a58d1d0a4b0a1437ef19af29679b368d2b9e9de3f8769b3578667612251624de6420bd03de9f8ab29e2800094e153fac6f696cfa512536c9c2f804dcb2c2c4e4aed61880a094a58d1d2080a094a58d1d0a4b0a1462633d9db7ed78e951f79913fdc8231aa77ec12b12251624de64208f4a74a07351895ddf373057b98fae6dfaf2cd21f37a063e19601078fe470d531880a094a58d1d2080a094a58d1d0a4b0a1491844d296bd8e591448efc65fd6ad51a888d58fa12251624de6420c80e9abef7ff439c10c68fe8f1303deddfc527718c3b37d8ba6807446e3c827a1880a094a58d1d2080a094a58d1d0a4f0a149ccddd479c0ad8dcd01d754dd95fe15384e8bbdc12251624de64204d1be64f0e9a466c2e66a53433928192783e29f8fa21beb2133499b5ef770f601880c0a8ca9a3a2080808dc2e0a2fdffff010a4b0a14b3727172ce6473bc780298a2d66c12f1a14f5b2a12251624de64209142afcc691b7cc05d26c7b0be0c8b46418294171730e079f384fde2fa50bafc1880a094a58d1d2080a094a58d1d0a4b0a14b6f20c7faa2b2f6f24518fa02b71cb5f4a09fba312251624de642049b288e4ebbb3a281c2d546fc30253d5baf08993b6e5d295fb787a5b314a298e1880a094a58d1d2080a094a58d1d0a4b0a14d4cecef238e778c7063552c3a7ab95da35c3fb4712251624de642099308aa365c40554bc89982af505d85da95251445d5dd4a9bb37dd2584fd92d31880a094a58d1d2080a094a58d1d0a4b0a14f15ab82564d6f450ca6f30a074568a5e6dee7b9b12251624de6420df33205d0974d06f3f5d32e6fd98e5debd7ec39a796455f93c63aeef0dadb31a1880c0a8ca9a3a2080c0a8ca9a3a0a4b0a14f42f1d05ac568d12e26b9655395e7fbbd46bc5bb12251624de642001776920ff0b0f38d78cf95c033c21adf7045785114e392a7544179652e0a6121880a094a58d1d2080a094a58d1d124f0a149ccddd479c0ad8dcd01d754dd95fe15384e8bbdc12251624de64204d1be64f0e9a466c2e66a53433928192783e29f8fa21beb2133499b5ef770f601880c0a8ca9a3a2080808dc2e0a2fdffff011af1070a4b0a1406fd60078eb4c2356137dd50036597db267cf61612251624de6420e17cbe9c20cdcfdf876b3b12978d3264a007fcaaa71c4cdb701d9ebc0323f44f1880a094a58d1d2080a094a58d1d0a4b0a1418e69cc672973992bb5f76d049a5b2c5ddf7743612251624de6420184e7b103d34c41003f9b864d5f8c1adda9bd0436b253bb3c844bc739c1e77c91880a094a58d1d2080a094a58d1d0a4b0a14344c39bb8f4512d6cab1f6aafac1811ef9d8afdf12251624de64204d420aea843e92a0cfe69d89696dff6827769f9cb52a249af537ce89bf2a4b741880a094a58d1d2080a094a58d1d0a4b0a1437ef19af29679b368d2b9e9de3f8769b3578667612251624de6420bd03de9f8ab29e2800094e153fac6f696cfa512536c9c2f804dcb2c2c4e4aed61880a094a58d1d2080a094a58d1d0a4b0a1462633d9db7ed78e951f79913fdc8231aa77ec12b12251624de64208f4a74a07351895ddf373057b98fae6dfaf2cd21f37a063e19601078fe470d531880a094a58d1d2080a094a58d1d0a4b0a1491844d296bd8e591448efc65fd6ad51a888d58fa12251624de6420c80e9abef7ff439c10c68fe8f1303deddfc527718c3b37d8ba6807446e3c827a1880a094a58d1d2080a094a58d1d0a4f0a149ccddd479c0ad8dcd01d754dd95fe15384e8bbdc12251624de64204d1be64f0e9a466c2e66a53433928192783e29f8fa21beb2133499b5ef770f601880c0a8ca9a3a2080808dc2e0a2fdffff010a4b0a14b3727172ce6473bc780298a2d66c12f1a14f5b2a12251624de64209142afcc691b7cc05d26c7b0be0c8b46418294171730e079f384fde2fa50bafc1880a094a58d1d2080a094a58d1d0a4b0a14b6f20c7faa2b2f6f24518fa02b71cb5f4a09fba312251624de642049b288e4ebbb3a281c2d546fc30253d5baf08993b6e5d295fb787a5b314a298e1880a094a58d1d2080a094a58d1d0a4b0a14d4cecef238e778c7063552c3a7ab95da35c3fb4712251624de642099308aa365c40554bc89982af505d85da95251445d5dd4a9bb37dd2584fd92d31880a094a58d1d2080a094a58d1d0a4b0a14f15ab82564d6f450ca6f30a074568a5e6dee7b9b12251624de6420df33205d0974d06f3f5d32e6fd98e5debd7ec39a796455f93c63aeef0dadb31a1880c0a8ca9a3a2080c0a8ca9a3a0a4b0a14f42f1d05ac568d12e26b9655395e7fbbd46bc5bb12251624de642001776920ff0b0f38d78cf95c033c21adf7045785114e392a7544179652e0a6121880a094a58d1d2080a094a58d1d124f0a149ccddd479c0ad8dcd01d754dd95fe15384e8bbdc12251624de64204d1be64f0e9a466c2e66a53433928192783e29f8fa21beb2133499b5ef770f601880c0a8ca9a3a2080808dc2e0a2fdffff01")
var header37055764 = common2.Hex2Bytes("8b230aa0130abc020a02080a121442696e616e63652d436861696e2d47616e6765731894dad511220c0882e6a9a006108fb0d2cd03309d977c3a480a20f766188b97724a28b894ce6b37f6d9361d30dbff175844490bc7a62309ba7a521224080112207ab22fb54f9df1e6810eb202fde3c555aeb0d978c55b79a9859e6e8000fa5ed44220cea545c95b0b0a495e9ed3b623b631c353246c86f6503560e70f2f96d6881a8e5220dfb10d5c6390b8d4c63cdeffc6a27ebae82ccd0aa0f87cac8de3a1d9776f11535a20dfb10d5c6390b8d4c63cdeffc6a27ebae82ccd0aa0f87cac8de3a1d9776f11536220294d8fbd0b94b767a7eba9840f299a3586da7fe6b5dead3b7eecba193c400f936a20c6532cdade3b6fd7404d1cf39c98221c6b15140f2d3421c2500ce85ef657af2e820114344c39bb8f4512d6cab1f6aafac1811ef9d8afdf12de100a480a204efaec6d3dbd16b2fd58b15948e4eb737d4fc79883c86a8b175218f5e638e80e122408011220908bc4e02929131b223ea6a9604d0d9c8e27b2b1a4a4e3fb24507b35ad5a41ee12b70108021094dad51122480a204efaec6d3dbd16b2fd58b15948e4eb737d4fc79883c86a8b175218f5e638e80e122408011220908bc4e02929131b223ea6a9604d0d9c8e27b2b1a4a4e3fb24507b35ad5a41ee2a0c0885e6a9a00610a4b4db9402321406fd60078eb4c2356137dd50036597db267cf6164240c3187b2f11d69c0cffe9004e4a763610d674e864137f402565a149252e2056360828a54eb52615cf979d49883302ea80b939437c7dc44e27527890bbd295d10d12b90108021094dad51122480a204efaec6d3dbd16b2fd58b15948e4eb737d4fc79883c86a8b175218f5e638e80e122408011220908bc4e02929131b223ea6a9604d0d9c8e27b2b1a4a4e3fb24507b35ad5a41ee2a0c0885e6a9a0061087feb89502321418e69cc672973992bb5f76d049a5b2c5ddf77436380142401ac02f2ff858f3c5d125b9dbec2839a35e8a4f6dd3459a6c4db8d82b08f87082675455824d952def551bb6e63445fb8c52bedd705161700bd4b144bad7620d0a12b90108021094dad51122480a204efaec6d3dbd16b2fd58b15948e4eb737d4fc79883c86a8b175218f5e638e80e122408011220908bc4e02929131b223ea6a9604d0d9c8e27b2b1a4a4e3fb24507b35ad5a41ee2a0c0885e6a9a00610a29bf992023214344c39bb8f4512d6cab1f6aafac1811ef9d8afdf38024240e21dec4742016f8c883fc0bdff517e52f78e30145cfa4f548a7b5dd4f60ac8c3cd9fd797882081ec2afd94ee82a4c2f2baeb83c0a43535b3e94429f85df2090b12b90108021094dad51122480a204efaec6d3dbd16b2fd58b15948e4eb737d4fc79883c86a8b175218f5e638e80e122408011220908bc4e02929131b223ea6a9604d0d9c8e27b2b1a4a4e3fb24507b35ad5a41ee2a0c0885e6a9a0061099f3e38e02321437ef19af29679b368d2b9e9de3f8769b357866763803424042f5decef367abc2a0c540f48460c4784a18e46485daa0ecad314a5168eb042ce391d2c9a1038320a3a183db5ddbb7fbfb834787a900ef15939856027b7ced0c12b90108021094dad51122480a204efaec6d3dbd16b2fd58b15948e4eb737d4fc79883c86a8b175218f5e638e80e122408011220908bc4e02929131b223ea6a9604d0d9c8e27b2b1a4a4e3fb24507b35ad5a41ee2a0c0885e6a9a00610fcc1e7b202321462633d9db7ed78e951f79913fdc8231aa77ec12b3804424052107ee6979792f9c9767d47368fe274791a63db80c66dd276ecee2dd7caefea766ebb9226b00bb6926528d43106f593d2ee3d7143298110cfa34945a37df40712b90108021094dad51122480a204efaec6d3dbd16b2fd58b15948e4eb737d4fc79883c86a8b175218f5e638e80e122408011220908bc4e02929131b223ea6a9604d0d9c8e27b2b1a4a4e3fb24507b35ad5a41ee2a0c0885e6a9a00610af93d99202321491844d296bd8e591448efc65fd6ad51a888d58fa380542409e090277d12485ba2284c1797c0ca82cb0ad0d3895b1ef5ed8fa3c03e0c1368d26ff130aeb428c399a3707904478db7105a7b2f6875f0a8558561d477f6aea0f12b90108021094dad51122480a204efaec6d3dbd16b2fd58b15948e4eb737d4fc79883c86a8b175218f5e638e80e122408011220908bc4e02929131b223ea6a9604d0d9c8e27b2b1a4a4e3fb24507b35ad5a41ee2a0c0885e6a9a00610e3a6e1b20232149ccddd479c0ad8dcd01d754dd95fe15384e8bbdc380642408f37af42b560d3979ec267c03f2275b07f754e72f304b431127dab61fbbd48aa3dfca4a17f46f2216d26cc82899bf0e99ed1685f182c3b1d0dd44df72a22e10f12b90108021094dad51122480a204efaec6d3dbd16b2fd58b15948e4eb737d4fc79883c86a8b175218f5e638e80e122408011220908bc4e02929131b223ea6a9604d0d9c8e27b2b1a4a4e3fb24507b35ad5a41ee2a0c0885e6a9a00610a18bb3ba023214b3727172ce6473bc780298a2d66c12f1a14f5b2a38074240ccd21ab66f804fd4e2b761a5d1dc8e67975acae5352017277d4faead1ab5cbf8981198634d9bca8e49667859378beee3cb63d8c660f576439ffb8c1b7be4530112b90108021094dad51122480a204efaec6d3dbd16b2fd58b15948e4eb737d4fc79883c86a8b175218f5e638e80e122408011220908bc4e02929131b223ea6a9604d0d9c8e27b2b1a4a4e3fb24507b35ad5a41ee2a0c0885e6a9a006109dcb9cc2033214b6f20c7faa2b2f6f24518fa02b71cb5f4a09fba338084240ab50ce5906ecfc812908b9f785c29e7cfa45a9b063188f59adc9dd0804d828567182ea195c49ba5cf779da102ec3aec1ff510e6a84e9653fdf7eddb2a00df20d12b90108021094dad51122480a204efaec6d3dbd16b2fd58b15948e4eb737d4fc79883c86a8b175218f5e638e80e122408011220908bc4e02929131b223ea6a9604d0d9c8e27b2b1a4a4e3fb24507b35ad5a41ee2a0c0885e6a9a00610cabf98b3023214d4cecef238e778c7063552c3a7ab95da35c3fb4738094240887d3b2922f2a74bd334e2c9552b0eb015967d03469dd1071ddcaf30e996c4369fee17ef7e1def0b87cc0e5688a703074552056ca3b6d7298084dce1110bae07120012b90108021094dad51122480a204efaec6d3dbd16b2fd58b15948e4eb737d4fc79883c86a8b175218f5e638e80e122408011220908bc4e02929131b223ea6a9604d0d9c8e27b2b1a4a4e3fb24507b35ad5a41ee2a0c0885e6a9a00610e59b8ab2023214f42f1d05ac568d12e26b9655395e7fbbd46bc5bb380b4240e6947967e32408339c0d2bed1308484687cdd70a00f4e3d1812f8506f7fd843fdbdd82878532854540f43e7db4b10c8494254a4fd3d8eeec28be826659040a0812f1070a4b0a1406fd60078eb4c2356137dd50036597db267cf61612251624de6420e17cbe9c20cdcfdf876b3b12978d3264a007fcaaa71c4cdb701d9ebc0323f44f1880a094a58d1d2080a094a58d1d0a4b0a1418e69cc672973992bb5f76d049a5b2c5ddf7743612251624de6420184e7b103d34c41003f9b864d5f8c1adda9bd0436b253bb3c844bc739c1e77c91880a094a58d1d2080a094a58d1d0a4b0a14344c39bb8f4512d6cab1f6aafac1811ef9d8afdf12251624de64204d420aea843e92a0cfe69d89696dff6827769f9cb52a249af537ce89bf2a4b741880a094a58d1d2080a094a58d1d0a4b0a1437ef19af29679b368d2b9e9de3f8769b3578667612251624de6420bd03de9f8ab29e2800094e153fac6f696cfa512536c9c2f804dcb2c2c4e4aed61880a094a58d1d2080a094a58d1d0a4b0a1462633d9db7ed78e951f79913fdc8231aa77ec12b12251624de64208f4a74a07351895ddf373057b98fae6dfaf2cd21f37a063e19601078fe470d531880a094a58d1d2080a094a58d1d0a4b0a1491844d296bd8e591448efc65fd6ad51a888d58fa12251624de6420c80e9abef7ff439c10c68fe8f1303deddfc527718c3b37d8ba6807446e3c827a1880a094a58d1d2080a094a58d1d0a4f0a149ccddd479c0ad8dcd01d754dd95fe15384e8bbdc12251624de64204d1be64f0e9a466c2e66a53433928192783e29f8fa21beb2133499b5ef770f601880c0a8ca9a3a2080808dc2e0a2fdffff010a4b0a14b3727172ce6473bc780298a2d66c12f1a14f5b2a12251624de64209142afcc691b7cc05d26c7b0be0c8b46418294171730e079f384fde2fa50bafc1880a094a58d1d2080a094a58d1d0a4b0a14b6f20c7faa2b2f6f24518fa02b71cb5f4a09fba312251624de642049b288e4ebbb3a281c2d546fc30253d5baf08993b6e5d295fb787a5b314a298e1880a094a58d1d2080a094a58d1d0a4b0a14d4cecef238e778c7063552c3a7ab95da35c3fb4712251624de642099308aa365c40554bc89982af505d85da95251445d5dd4a9bb37dd2584fd92d31880a094a58d1d2080a094a58d1d0a4b0a14f15ab82564d6f450ca6f30a074568a5e6dee7b9b12251624de6420df33205d0974d06f3f5d32e6fd98e5debd7ec39a796455f93c63aeef0dadb31a1880c0a8ca9a3a2080c0a8ca9a3a0a4b0a14f42f1d05ac568d12e26b9655395e7fbbd46bc5bb12251624de642001776920ff0b0f38d78cf95c033c21adf7045785114e392a7544179652e0a6121880a094a58d1d2080a094a58d1d124f0a149ccddd479c0ad8dcd01d754dd95fe15384e8bbdc12251624de64204d1be64f0e9a466c2e66a53433928192783e29f8fa21beb2133499b5ef770f601880c0a8ca9a3a2080808dc2e0a2fdffff011af1070a4b0a1406fd60078eb4c2356137dd50036597db267cf61612251624de6420e17cbe9c20cdcfdf876b3b12978d3264a007fcaaa71c4cdb701d9ebc0323f44f1880a094a58d1d2080a094a58d1d0a4b0a1418e69cc672973992bb5f76d049a5b2c5ddf7743612251624de6420184e7b103d34c41003f9b864d5f8c1adda9bd0436b253bb3c844bc739c1e77c91880a094a58d1d2080a094a58d1d0a4b0a14344c39bb8f4512d6cab1f6aafac1811ef9d8afdf12251624de64204d420aea843e92a0cfe69d89696dff6827769f9cb52a249af537ce89bf2a4b741880a094a58d1d2080a094a58d1d0a4b0a1437ef19af29679b368d2b9e9de3f8769b3578667612251624de6420bd03de9f8ab29e2800094e153fac6f696cfa512536c9c2f804dcb2c2c4e4aed61880a094a58d1d2080a094a58d1d0a4b0a1462633d9db7ed78e951f79913fdc8231aa77ec12b12251624de64208f4a74a07351895ddf373057b98fae6dfaf2cd21f37a063e19601078fe470d531880a094a58d1d2080a094a58d1d0a4b0a1491844d296bd8e591448efc65fd6ad51a888d58fa12251624de6420c80e9abef7ff439c10c68fe8f1303deddfc527718c3b37d8ba6807446e3c827a1880a094a58d1d2080a094a58d1d0a4f0a149ccddd479c0ad8dcd01d754dd95fe15384e8bbdc12251624de64204d1be64f0e9a466c2e66a53433928192783e29f8fa21beb2133499b5ef770f601880c0a8ca9a3a2080808dc2e0a2fdffff010a4b0a14b3727172ce6473bc780298a2d66c12f1a14f5b2a12251624de64209142afcc691b7cc05d26c7b0be0c8b46418294171730e079f384fde2fa50bafc1880a094a58d1d2080a094a58d1d0a4b0a14b6f20c7faa2b2f6f24518fa02b71cb5f4a09fba312251624de642049b288e4ebbb3a281c2d546fc30253d5baf08993b6e5d295fb787a5b314a298e1880a094a58d1d2080a094a58d1d0a4b0a14d4cecef238e778c7063552c3a7ab95da35c3fb4712251624de642099308aa365c40554bc89982af505d85da95251445d5dd4a9bb37dd2584fd92d31880a094a58d1d2080a094a58d1d0a4b0a14f15ab82564d6f450ca6f30a074568a5e6dee7b9b12251624de6420df33205d0974d06f3f5d32e6fd98e5debd7ec39a796455f93c63aeef0dadb31a1880c0a8ca9a3a2080c0a8ca9a3a0a4b0a14f42f1d05ac568d12e26b9655395e7fbbd46bc5bb12251624de642001776920ff0b0f38d78cf95c033c21adf7045785114e392a7544179652e0a6121880a094a58d1d2080a094a58d1d124f0a149ccddd479c0ad8dcd01d754dd95fe15384e8bbdc12251624de64204d1be64f0e9a466c2e66a53433928192783e29f8fa21beb2133499b5ef770f601880c0a8ca9a3a2080808dc2e0a2fdffff01")
var msgFor1747 = common2.Hex2Bytes("000000000000000000000000000000000000000000000000000008e1bc9bf04000f9028b80f90287f846941284214b9b9c85549ab3d2b972df0deef66ac2c9946ddf42a51534fc98d0c0a3b42c963cace8441ddf9477f066f3fb515bb97015e4b4afddbcb25c94286b863a7a0af71ab3f84694a2959d3f95eae5dc7d70144ce1b73b403b7eb6e0948081ef03f1d9e0bb4a5bf38f16285c879299f07f940ce09b38374887cb564b7efa60be130d99ed5f958634396b4d74cff84694b71b214cb885500844365e95cd9942c7276e7fd894d22ca3ba2141d23adab65ce4940eb7665ea2b6a794748c284f46ab87fd492326f1e2fe731d22ad2db3862c884097f7b2f84694980a75ecd1309ea12fa2ed87a8744fbfc9b863d594cc6ac05c95a99c1f7b5f88de0e3486c82293b2709407eecf36cf0901fefe4bc505d6ba03c7480c7b57862bb8b2be9df3f8469435552c16704d214347f29fa77f77da6d75d7c75294dc4973e838e3949c77aced16ac2315dc2d7ab11194f57d36e129881a3a13a024fe8072507e5b2e70f8862b52882254abf84694f474cf03cceff28abc65c9cbae594f725c80e12d94e61a183325a18a173319dd8e19c8d069459e217594ddfcaedf9bb451098c9917a45f02bd61342cca6686185381bac954f8469496c5d20b2a975c050e4220be276ace4892f4b41a9496c5d20b2a975c050e4220be276ace4892f4b41a94d83534ce35b13f84f54d11fa1d433dee3c75f9f9860e811a91eb42f84694c5d15ef572d27f4f3087e17ee9099b760b1151c294c5d15ef572d27f4f3087e17ee9099b760b1151c294749678d00a66b8a820d92ad6131f3dcd47a9132186010040cffbc0f845946d6247501b822fd4eaa76fcb64baea360279497f941e481301b8c32d6a3d318b54aad7bc4a5c2b1caa94f6001c9d74e1ba71769f0633f6d690febd9b970b85ea4c276f00")
var proofFor1747 = common2.Hex2Bytes("0a84060a066961766c3a76120e00000100610800000000000006d31ae905e7050ae4050a2c080f10cb4f1893dad51122206dbbc25bbb1e725c2128fd27aca6c2f01214a35b4198f77dcd53ce4876fce94d0a2c080e10c5261893dad5112220075ac52d4ba9c8dc7e27a2506ec444699c285988ba8be8c001f53c64bb9fe4ce0a2c080d10a8121893dad5112220feb2d51a4e39edfad2a5c7a8506255f12ea815902f25fbbd97f54138c3f11fed0a2c080c10e90b1893dad5112a2050b9115d5c4f5e59ce6ff13b56e9fc5c1e9582c6fbfcb134c59fdf2a013874c00a2c080b10a0081893dad5112220ff0dc31de2fca920a4140ba3de827e2dbdaeb7ba553ae4b07f35b9e023e7bea50a2c080a10a0041893dad51122202440798090528dfa52f65fcf7485c1abd82c01415a4e1f42dccdb74c41060ff80a2c080910a0021893dad5112220de10985ce05b98f3d64683d1b5e0cb7bbcd46f1008bbf05c5236404ef7f6c6bf0a2c080810a0011893dad511222016a5b5c7745e4c0e85691264cdb181a2a0fdf8c3312f364c442889a4efc94c260a2b080710601893dad5112220c52b24da586e113b532c4cefabcecf4a12a9e8dd9b0315e240af2fd875496c890a2b080610401893dad51122201efdd90ce73fb1c410e5f3173df6494f4322df431a540cb32972b03db45141bb0a2b080510201893dad51122201ace51c014b6c9723bb8451fd47310d6ffdbad7ef4ae8fa7e42c5624b0447fe80a2b080410101893dad511222097c43dbccb33fb86755adc399ada082386154ebac0bed856cb7a62f52ca349790a2b080310081893dad51122204d9a7fccae2f445b438571e40fbb277c5d59f99d27cd1e69f45aae48fa4c0f660a2b080210041893dad511222059383515ab18d6a0389b7e4f7e22aeb31bdcdd1c5a44709f4dbfac2816ade6f10a2b080110021893dad5112220a00c7fcd16c63d83e665c36f8d3e1af728e12d47c6a3371fa11511dccadce4ce1a370a0e00000100610800000000000006d3122039d1883699e5c2f30261168f4af6019ed978b1d858ecd3189c5c66b2f84cf69c1893dad5110ab1060a0a6d756c746973746f726512036962631a9d069b060a98060a380a0b61746f6d69635f7377617012290a270893dad5111220dd901f30ea48b65279238839310618d7adc563f93d7373411003743655e791c30a330a06706172616d7312290a270893dad5111220db9a4440e34c6975caf0fa8f7832fe620f8fd8c623b070000bcdd443f0beb4fd0a320a05706169727312290a270893dad51112208e7bac27b51bd3259a4a2bc827eb5fa3935472dbb325970a423d44dfd7752a7b0a350a08736c617368696e6712290a270893dad51112208b13a181266f078a777c8468cd7764cfc14b45d101ef39f3f3e8611fb5e9ebeb0a110a066f7261636c6512070a050893dad5110a300a0361636312290a270893dad5111220ef56cefa3b0be5c2c53850ab0305bc384b5f958bdd9121b37b5f71e7303eafa50a330a06746f6b656e7312290a270893dad5111220b19c4b0458dffa6ce947441c46caded89a772f548c03f524f49ff926d2173a330a330a0662726964676512290a270893dad51112208ac15f258b9c05d02a525b620849ffb6db34bd0230730041d1791bf0c7cb22b90a390a0c7374616b655f72657761726412290a270893dad5111220cf5def8d0d9056b92a03d27433c345b2b841f70c7211a5250b0ca01f8fb4852b0a300a03676f7612290a270893dad51112209ec52456da0f878dbc7070d650e728bb8efa3cfcf7578a2822efe4e519ca3f830a300a0369626312290a270893dad5111220146570a3518bdc5b3c1aa41d92a2d9760ee39f7a32d6f48da2bb54f2298684d80a360a0974696d655f6c6f636b12290a270893dad51112209094c71319a18c11c2a218c0827be8131dd3b8aeccc1848de9ecf5114513e2a90a0e0a0376616c12070a050893dad5110a2f0a02736312290a270893dad5111220fb2e29cc5e68b21e3c569a2a1742bdd7dc582a58c032069993f64153cf6bf98c0a0f0a046d61696e12070a050893dad5110a300a0364657812290a270893dad51112201c49a94c231482a9af90867560d032341fd7b29c199a012cef15bc48149805a70a320a057374616b6512290a270893dad51112201d7bce92fdc636b7705a6377311efd94270dd168c3b86658375401354fb543dd")

var bbcValidatorHash = common2.Hex2Bytes("dfb10d5c6390b8d4c63cdeffc6a27ebae82ccd0aa0f87cac8de3a1d9776f1153")
var bscValidatorHash = common2.Hex2Bytes("05ed92dab8ad5fc62ecbd7513892ec9b50d4f9d20242360b2b56ef22233afcb5")

var validHeight = map[uint64]bool{36647110: true, 37055763: true}
var seqs = map[uint64]uint64{36647110: 1733, 37055763: 1747}
var headers = map[uint64][]byte{36647110: header36647110, 36647111: header36647111, 37055763: header37055763, 37055764: header37055764}
var msgs = map[uint64][]byte{1733: msgFor1733, 1747: msgFor1747}
var proofs = map[uint64][]byte{1733: proofFor1733, 1747: proofFor1747}

type mockRelayer struct {
	height   uint64
	bbcHash  []byte
	bscHash  []byte
	sequence uint64
	syncedAt uint64
}

var _ Relayer = &mockRelayer{}

func NewMockRelayer() Relayer {
	return newMockRelayer()
}

// a mock relayer on testnet
func newMockRelayer() *mockRelayer {
	return &mockRelayer{
		height:   37055763,
		bbcHash:  bbcValidatorHash,
		bscHash:  bscValidatorHash,
		sequence: 1747,
		syncedAt: 0,
	}
}

func (m *mockRelayer) SetupInitialState(height string, bbcHash, bscHash []byte) {
	h, err := strconv.Atoi(height)
	if err == nil && validHeight[uint64(h)] {
		m.height = uint64(h)
		m.sequence = seqs[m.height]
	}
	if len(bbcHash) != 0 {
		m.bbcHash = bbcHash
	}
	if len(bscHash) != 0 {
		m.bscHash = bscHash
	}
}

func (m *mockRelayer) NewCallback2WithBSCHashCheck(callback RelayCrossChainPackageCallbackFunc) RelayCrossChainPackageCallbackFunc {
	return func(pkg *executor.CrossChainPackage) {
		bscChanged, newBscHash, _ := executor.FindBscValidatorSetChangePackage(m.bscHash, []*executor.CrossChainPackage{pkg})
		if bscChanged {
			m.bscHash = newBscHash
			callback(pkg)
		}
	}
}

func (m *mockRelayer) MonitorStakingModule(callback1 SyncBBCHeaderCallbackFunc, callback2 RelayCrossChainPackageCallbackFunc) {
	log.Infof("Start mock monitor all packages in channel 8 from height %d, current bbc vals hash %x, bsc vals hash %x",
		m.height, m.bbcHash, m.bscHash)
	time.Sleep(3 * time.Second)
	h0 := new(common.Header)
	err := common.Cdc.UnmarshalBinaryLengthPrefixed(headers[m.height], h0)
	if err != nil {
		panic(err)
	}
	if !bytes.Equal(m.bbcHash, bbcValidatorHash) {
		callback1(h0)
		m.bbcHash = bbcValidatorHash
	}

	time.Sleep(3 * time.Second)
	h1 := new(common.Header)
	err = common.Cdc.UnmarshalBinaryLengthPrefixed(headers[m.height+1], h1)
	if err != nil {
		panic(err)
	}
	callback1(h1)
	callback2(&executor.CrossChainPackage{
		Height:    m.height,
		ChannelID: 8,
		Sequence:  m.sequence,
		Msg:       msgs[m.sequence],
		Proof:     proofs[m.sequence],
	})
}

func (m *mockRelayer) GetBBCStatus() (model.BbcStatus, error) {
	return model.BbcStatus{
		NetworkID:   0,
		Height:      m.height,
		BbcValsHash: common2.Bytes2Hex(m.bbcHash),
		BscValsHash: common2.Bytes2Hex(m.bscHash),
		StakeModSeq: m.sequence,
		SyncedAt:    m.syncedAt,
	}, nil
}

func (m *mockRelayer) UpdateAfterSync(height uint64) error {
	m.syncedAt = height
	return nil
}
